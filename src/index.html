<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2-SAT Solver</title>
    <style>
        canvas {
            border: 1px solid black;
            display: block;
            margin: auto;
        }
    </style>
</head>
<body>
    <h1>2-SAT Solver with Graphical Input</h1>
    <canvas id="canvas" width="800" height="600"></canvas>
    <button id="solve">Solve</button>
    <script type="module">
        import init, { TwoSAT } from './pkg/two_sat_wasm.js';

        async function main() {
            await init();

            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');

            const solver = new TwoSAT(5); // Initialize for 5 variables
            const nodes = [];
            const edges = [];

            canvas.addEventListener('click', (event) => {
                const rect = canvas.getBoundingClientRect();
                const x = event.clientX - rect.left;
                const y = event.clientY - rect.top;

                nodes.push({ x, y });
                ctx.beginPath();
                ctx.arc(x, y, 10, 0, Math.PI * 2);
                ctx.fillStyle = 'blue';
                ctx.fill();
                ctx.closePath();
            });

            canvas.addEventListener('contextmenu', (event) => {
                event.preventDefault();
                if (nodes.length >= 2) {
                    const from = nodes[nodes.length - 2];
                    const to = nodes[nodes.length - 1];
                    edges.push({ from, to });

                    ctx.beginPath();
                    ctx.moveTo(from.x, from.y);
                    ctx.lineTo(to.x, to.y);
                    ctx.strokeStyle = 'red';
                    ctx.stroke();
                    ctx.closePath();

                    solver.add_clause(nodes.length - 2, false, nodes.length - 1, false);
                }
            });

            document.getElementById('solve').addEventListener('click', () => {
                if (solver.solve()) {
                    alert('Satisfiable! Assignment: ' + solver.get_assignment());
                } else {
                    alert('Not satisfiable!');
                }
            });
        }

        main();
    </script>
</body>
</html>
